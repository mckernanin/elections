jQuery(function(e){e(document).ready(function(){function t(){e.ajax({url:"/wp-json/oa-elections/v1/reports/elections_by_chapter",dataType:"json"}).done(function(t){e(".scheduled").text(t.sum);var a=[],o=[];e.each(t.results,function(e,t){a.push(e),o.push(t)});var n={labels:a,legend:"",datasets:[{backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)","rgba(134,189,74, 0.6)"],strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:o}]},i=document.getElementById("scheduled_elections");new Chart(i,{type:"pie",data:n})})}function a(){e.ajax({url:"/wp-json/oa-elections/v1/reports/candidates_by_chapter",dataType:"json"}).done(function(t){e(".elected").text(t.sum);var a=[],o=[];e.each(t.results,function(e,t){a.push(e),o.push(t)});var n={labels:a,legend:"",datasets:[{backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)","rgba(134,189,74, 0.6)"],strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:o}]},i=document.getElementById("candidates_elected");new Chart(i,{type:"pie",data:n})})}if(e("body").hasClass("section-ballots")){for(var o=e(".ballots"),n=e(".site-main").outerHeight(),i=Math.floor(e(".ballots:nth-of-type(odd)").length),s=e(".ballots").outerHeight(),l=i*s;l<n;)o.clone().insertAfter(".ballots:first-of-type"),i=Math.floor(e(".ballots:nth-of-type(odd)").length),l=i*s;o.clone().insertAfter(".ballots:first-of-type")}if(e("body").hasClass("page-stats")&&(Chart.defaults.global.legend.position="bottom",t(),a()),e("#election-calendar").on("click",".fc-event",function(t){var a=e('*[class*="unit-"]').filter(function(){return this.className.match(/(?:^|\s)unit-/)});-1!=e(this).attr("href").indexOf("unit_date")&&(t.preventDefault(),a.removeClass("selected-election"),e(this).toggleClass("selected-election"))}),e("#schedule-elections").on("click",function(){var t={};if(t.elements=e(".selected-election"),t.elements.length){t.data=[];var a=confirm("Do you want to schedule these elections? This action cannot be undone, and will notify the units.");1==a&&(e.each(t.elements,function(){var a=e(this).attr("href").split("_");a[0]=a[0].replace("#","");var o={postID:a[0],selectedDate:a[3]};t.data.push(o)}),e.ajax({url:"/wp-json/oa-elections/v1/schedule-election",type:"post",data:{elections:t.data},success:function(t){e("#election-calendar").fullCalendar("refetchEvents"),e("#schedule-response").text(t.message),console.log("scheduled!")},fail:function(e){alert(e)}}))}}),e("#adult-nominations").length&&e(".status-button").on("click",function(){var t=e(this).data("status"),a=e(this).data("id"),o=e(this);e('button[data-id="'+a+'"]').removeClass("active"),e.ajax({url:"/wp-json/oa-elections/v1/set-nomination-status",type:"post",data:{id:a,status:t},success:function(){setTimeout(function(){o.addClass("active")},4e3)},fail:function(e){alert(e)}}),setTimeout(function(){o.addClass("active")},1e3)}),e("body").hasClass("section-report")){var c={ID:document.body.className.match(/(^|\s)postid-(\d+)(\s|$)/)[2],registeredActiveYouth:0,youthAttendance:0,electionOne:{ballots:0,required:0},electionTwo:{ballots:0,required:0},candidates:[]};e("#registeredActiveYouth").on("change",function(){c.registeredActiveYouth=Math.abs(e(this).val())}),e("#youthAttendance").on("change",function(){c.youthAttendance=Math.abs(e(this).val()),null!==c.youthAttendance&&0!==c.youthAttendance&&c.youthAttendance<=c.registeredActiveYouth/2&&alert("Please check your input, over 50% of active members must be in attendance.")}),e("#electionOneBallots").on("change",function(){c.electionOne.ballots=Math.abs(e(this).val()),c.electionOne.required=Math.ceil(c.electionOne.ballots/2),e("#electionOneRequired").val(c.electionOne.required)}),e("#electionTwoBallots").on("change",function(){c.electionTwo.ballots=Math.abs(e(this).val()),c.electionTwo.required=Math.ceil(c.electionTwo.ballots/2),c.electionTwo.required===c.electionTwo.ballots/2&&(c.electionTwo.required=c.electionTwo.required+1),e("#electionTwoRequired").val(c.electionTwo.required)}),e('input[type="checkbox"]').on("change",function(){this.checked&&c.candidates.push(Math.abs(e(this).attr("name")))}),e("#submit-election-results").on("click",function(){e(this).attr("disabled",!0),e.ajax({url:"/wp-json/oa-elections/v1/set-election-results",type:"post",data:{report:c},success:function(){Raven.captureMessage("Election Report Submitted",{level:"info",extra:c}),setTimeout(function(){location.reload()},4e3)},fail:function(e){Raven.captureMessage(e,{level:"error",extra:c}),alert(e)}})}),e(".election-data input").trigger("change")}e("#_oa_election_unit_location").attr("required",!0),e("#_oa_candidate_address_address_2").attr("required",!1),e("#_oa_nomination_address_address_2").attr("required",!1),e("#_oa_election_unit_location").on("change",function(){var t=e(this).val();e("#_oa_election_unit_address_text").val(t)}),e(".cmb-form").length&&e(".cmb-form").parsley()})});